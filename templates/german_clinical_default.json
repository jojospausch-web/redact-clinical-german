{
  "template_name": "German-Clinical-Structured-v2",
  "version": "2.0.0",
  
  "zones": {
    "header": {
      "page": 1,
      "y_start": 0,
      "y_end": 120,
      "redaction": "full",
      "preserve_logos": true
    },
    "footer": {
      "pages": "all",
      "y_start": 750,
      "y_end": 842,
      "redaction": "keyword_based",
      "keywords": ["IBAN", "Bankverbindung", "Sparkasse", "BIC", "Stiftung", "Vorstand"]
    }
  },
  
  "structured_patterns": {
    "patient_block": {
      "pattern": "^(Herr|Frau)\\s+([A-ZÄÖÜ][a-zäöüß-]+),\\s+([A-ZÄÖÜ][a-zäöüß-]+),\\s+\\*(\\d{2}\\.\\d{2}\\.\\d{4})",
      "comment": "^ = only at line beginning, prevents 'Sehr geehrter Herr Kollege'",
      "groups": {
        "1": "SALUTATION",
        "2": "LASTNAME",
        "3": "FIRSTNAME",
        "4": "BIRTHDATE"
      }
    },
    "case_id": {
      "pattern": "Pat\\.?-?Nr\\.?:?\\s*([0-9]{6,10})",
      "type": "CASE_ID"
    },
    "address": {
      "pattern": "([A-ZÄÖÜ][a-zäöüß]+(?:straße|str\\.|weg|platz|allee))\\s+(\\d+[a-z]?),?\\s+(\\d{5})\\s+([A-ZÄÖÜ][a-zäöüß]+)",
      "type": "ADDRESS"
    },
    "doctor_name": {
      "pattern": "((?:Prof\\.|Dr\\.|PD)\\s+(?:med\\.\\s+)?[A-ZÄÖÜ][a-zäöüß-]+(?:\\s+[A-ZÄÖÜ][a-zäöüß-]+)*)",
      "type": "DOCTOR_NAME",
      "comment": "Captures complete doctor name as single group"
    },
    "doctor_with_location": {
      "pattern": "Dr\\.\\s+([A-ZÄÖÜ][a-zäöüß-]+)(?:,\\s+([A-Z]{2,})\\s+([A-ZÄÖÜ][a-zäöüß]+))?",
      "comment": "Captures 'Dr. Führig, MVZ Hannover'",
      "groups": {
        "1": "DOCTOR_NAME",
        "2": "ORGANIZATION",
        "3": "CITY"
      }
    },
    "doctor_signature": {
      "context_trigger": "Mit freundlichen Grüßen",
      "pattern": "(Prof\\.|Dr\\.|PD)\\s+(med\\.\\s+)?([A-ZÄÖÜ][a-zäöüß-]+(?:\\s+[A-ZÄÖÜ][a-zäöüß-]+)+)",
      "type": "DOCTOR_NAME",
      "lookahead": 200
    },
    "referring_doctor": {
      "context_trigger": "Zuweiser",
      "pattern": "Dr\\.\\s+([A-ZÄÖÜ][a-zäöüß-]+)",
      "type": "REFERRING_DOCTOR"
    },
    "postal_code_with_city": {
      "pattern": "(\\d{5})\\s+([A-ZÄÖÜ][a-zäöüß]+)",
      "groups": {
        "1": "POSTAL_CODE",
        "2": "CITY"
      }
    },
    "postal_code_standalone": {
      "pattern": "(?:PLZ:?\\s*)?(\\d{5})(?!\\d)",
      "type": "POSTAL_CODE"
    }
  },
  
  "location_anonymization": {
    "enabled": true,
    "city_database": "data/cities_de.txt",
    "facilities_database": "data/medical_facilities_de.json",
    
    "context_triggers": {
      "prepositions": ["in", "aus", "nach", "von", "bei"],
      "facility_keywords": [
        "Universitätsklinikum", "Uniklinik", "Klinikum", "Krankenhaus",
        "Herzzentrum", "Tumorzentrum", "Lungenzentrum", "MVZ", "Charité",
        "Medizinisches Versorgungszentrum"
      ],
      "referral_keywords": ["überwiesen", "Zuweiser", "eingewiesen", "verlegt"]
    },
    
    "location_blacklist": [
      "UKE",
      "Charité",
      "Northeim",
      "Eppendorf"
    ],
    
    "replacement": "[ORT]",
    "facility_replacement": "[KLINIK]"
  },
  
  "date_handling": {
    "birthdate": {
      "pattern": "\\*(\\d{2}\\.\\d{2}\\.\\d{4})",
      "action": "shift",
      "shift_days_range": [-30, 30]
    },
    "german_full_date": {
      "pattern": "\\b(\\d{1,2})\\. (Januar|Februar|März|April|Mai|Juni|Juli|August|September|Oktober|November|Dezember) (\\d{4})\\b",
      "action": "shift"
    },
    "german_abbr_date": {
      "pattern": "\\b(\\d{1,2})\\. (Jan|Feb|Mär|Apr|Mai|Jun|Jul|Aug|Sep|Okt|Nov|Dez)\\.? (\\d{4})\\b",
      "action": "shift"
    },
    "numeric_date": {
      "pattern": "\\b(\\d{2})\\.(\\d{2})\\.(\\d{4})\\b",
      "action": "shift"
    },
    "date_with_context": {
      "pattern": "(?:vom|bis|am|seit|zum)\\s+(\\d{1,2})\\.(\\d{1,2})(?:\\.(\\d{4}))?",
      "comment": "Captures '05.08 bis zum 21.08.2023'",
      "action": "shift"
    },
    "treatment_dates": {
      "pattern": "\\b(\\d{2}\\.\\d{2}\\.\\d{4})\\b",
      "action": "shift_relative"
    }
  },
  
  "pii_mechanisms": {
    "PATIENT_NAME": "redact",
    "DOCTOR_NAME": "redact",
    "REFERRING_DOCTOR": "redact",
    "ADDRESS": "redact",
    "CITY": "redact",
    "ORGANIZATION": "redact",
    "MEDICAL_FACILITY": "redact",
    "DATE": "shift_date",
    "BIRTHDATE": "shift_date",
    "CASE_ID": "redact",
    "PHONE": "redact",
    "EMAIL": "redact",
    "IBAN": "redact",
    "SALUTATION": "redact",
    "LASTNAME": "redact",
    "FIRSTNAME": "redact",
    "POSTAL_CODE": "redact"
  },
  
  "image_pii_patterns": {
    "case_number": "\\d{6,10}",
    "name": "^[A-ZÄÖÜ][a-zäöüß]+\\s+[A-ZÄÖÜ][a-zäöüß]+$",
    "birthdate": "\\d{2}\\.\\d{2}\\.\\d{4}"
  },
  
  "info": "Template für deutsche medizinische Arztbriefe mit kontextbasierter Orts-/Einrichtungserkennung und deutschen Monats-Namen."
}

